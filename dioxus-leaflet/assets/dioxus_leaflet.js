async function u(){let t=window.L;while(!t)await s(100),t=window.L;return t}function s(t){return new Promise((e)=>setTimeout(e,t))}var y=new Map;function w(t){return y.get(t)}async function x(t,e,o){let r=await u(),n=y.get(t)??r.map(`dioxus-leaflet-map-${t}`,{zoomControl:o.zoom_control,scrollWheelZoom:o.scroll_wheel_zoom,doubleClickZoom:o.double_click_zoom,touchZoom:o.touch_zoom,dragging:o.dragging,keyboard:o.keyboard,attributionControl:o.attribution_control});y.set(t,n),n.setView(e.coordinates,e.zoom),r.tileLayer(o.tile_layer.url,{attribution:o.tile_layer.attribution,maxZoom:o.tile_layer.max_zoom,subdomains:o.tile_layer.subdomains}).addTo(n),await s(100),n.invalidateSize()}function l(t){y.delete(t)}async function $(t,e){await u();let o=w(t);if(!o)throw Error(`Map with id ${t} not found when setting onClick handler`);o.on("click",async(r)=>{console.log("js-pre");try{await e([r.latlng.lat,r.latlng.lng])}catch(n){console.error("Error in on_map_click callback:",n)}console.log("js-post")}),await new Promise(()=>{})}var g=new Map;function I(t){return g.get(t)}async function R(t,e,o,r){let n=await u(),f=w(t);if(!f)throw Error(`Map with id ${t} not found when updating polygon ${e}`);let p=g.get(e)??n.polygon([]).addTo(f);g.set(e,p),p.setLatLngs(o),p.setStyle(r);let d=L(e);if(d)p.unbindPopup(),p.bindPopup(d.body,d.options)}async function T(t,e){let o=await u();if(!w(t))throw Error(`Map with id ${t} not found when deleting polygon ${e}`);g.delete(e)}var a=new Map;function L(t){return a.get(t)}async function B(t,e,o){let r=await u(),n=`dioxus-leaflet-popup-${e}`,f=document.getElementById(n);if(!f)throw Error(`Popup body element with id ${n} not found when updating popup for object ${t}`);a.set(t,{body:f,options:o});let p=m(t)??I(t);if(p)p.unbindPopup(),p.bindPopup(f,o)}var c=new Map;function m(t){return c.get(t)}async function z(t,e,o,r){let n=await u(),f=w(t);if(!f)throw Error(`Map with id ${t} not found when updating marker ${e}`);let p=c.get(e)??n.marker([0,0]).addTo(f);if(c.set(e,p),p.setLatLng(o),r)p.setIcon(n.icon(r));let d=L(e);if(d)p.unbindPopup(),p.bindPopup(d.body,d.options)}async function A(t,e){let o=await u(),r=w(t);if(!r)throw Error(`Map with id ${t} not found when deleting marker ${e}`);let n=c.get(e);if(!n)throw Error(`Marker with id ${e} not found when deleting`);r.removeLayer(n),c.delete(e)}export{B as update_popup,R as update_polygon,z as update_marker,x as update_map,$ as on_map_click,L as get_popup,I as get_polygon,m as get_marker,w as get_map,T as delete_polygon,A as delete_marker,l as delete_map};
