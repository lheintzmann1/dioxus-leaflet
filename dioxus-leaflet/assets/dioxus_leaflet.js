async function setup(){let l=window.L;while(!l)await wait(100),l=window.L;return l}function wait(ms){return new Promise((resolve)=>setTimeout(resolve,ms))}var _maps=new Map;function get_map(map_id){return _maps.get(map_id)}async function update_map(map_id,initial_position,options){let l=await setup(),map=_maps.get(map_id)??l.map(`dioxus-leaflet-${map_id}`,{zoomControl:options.zoom_control,scrollWheelZoom:options.scroll_wheel_zoom,doubleClickZoom:options.double_click_zoom,touchZoom:options.touch_zoom,dragging:options.dragging,keyboard:options.keyboard,attributionControl:options.attribution_control});_maps.set(map_id,map),map.setView(initial_position.coordinates,initial_position.zoom),l.tileLayer(options.tile_layer.url,{attribution:options.tile_layer.attribution,maxZoom:options.tile_layer.max_zoom,subdomains:options.tile_layer.subdomains}).addTo(map),await wait(100),map.invalidateSize()}function delete_map(map_id){_maps.delete(map_id)}var _markers=new Map;function get_marker(marker_id){return _markers.get(marker_id)}async function update_marker(map_id,marker_id,coordinate,icon){let l=await setup(),map=get_map(map_id);if(!map)throw Error(`Map with id ${map_id} not found when updating marker ${marker_id}`);let marker=_markers.get(marker_id)??l.marker([0,0]).addTo(map);if(_markers.set(marker_id,marker),marker.setLatLng(coordinate),icon)marker.setIcon(l.icon({iconUrl:icon.icon_url,iconSize:icon.icon_size,iconAnchor:icon.icon_anchor,popupAnchor:icon.popup_anchor,shadowUrl:icon.shadow_url,shadowSize:icon.shadow_size}))}async function delete_marker(map_id,marker_id){let l=await setup(),map=get_map(map_id);if(!map)throw Error(`Map with id ${map_id} not found when deleting marker ${marker_id}`);let marker=_markers.get(marker_id);if(!marker)throw Error(`Marker with id ${marker_id} not found when deleting`);map.removeLayer(marker),_markers.delete(marker_id)}var _popups=new Map;async function update_popup(id,body_id,options){let body=document.getElementById(`dioxus-leaflet-popup-${body_id}`);if(!body)throw Error(`Popup body element with id dioxus-leaflet-popup-${body_id} not found when updating popup for object ${id}`);_popups.set(id,{body,options});let marker=get_marker(id);if(marker)marker.unbindPopup(),marker.bindPopup(body,{maxWidth:options.max_width,minWidth:options.min_width,maxHeight:options.max_height,autoPan:options.auto_pan,keepInView:options.keep_in_view,closeButton:options.close_button,autoClose:options.auto_close,closeOnEscapeKey:options.close_on_escape_key,className:options.class_name})}export{update_popup,update_marker,update_map,get_marker,get_map,delete_marker,delete_map};
